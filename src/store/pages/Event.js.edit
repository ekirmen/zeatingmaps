let precio = 0;
    let tipoPrecio = null;
    let descuentoNombre = null;

    if (priceTemplate && priceTemplate.detalles) {
      // Assuming priceTemplate.detalles is an array of price details with zona and precio
      const detalle = priceTemplate.detalles.find(d => d.zona === zonaId);
      if (detalle) {
        precio = detalle.precio || 0;
        tipoPrecio = detalle.tipoPrecio || null;
        descuentoNombre = detalle.descuentoNombre || null;
      }
    }

    setCart(prevCart => {
      if (!prevCart) {
        return [{ sillaId, zonaId, precio, quantity: 1, tipoPrecio, descuentoNombre }];
      }
      const existingItemIndex = prevCart.findIndex(item => item.sillaId === sillaId);
      if (existingItemIndex > -1) {
        return prevCart.filter(item => item.sillaId !== sillaId);
      } else {
        return [...prevCart, { sillaId, zonaId, precio, quantity: 1, tipoPrecio, descuentoNombre }];
      }
    });
  }, [priceTemplate]);
=======
  const toggleSillaEnCarrito = useCallback((silla, elemento) => {
    const sillaId = silla._id || silla.id || null;
    const zonaId = silla.zona || elemento.zonaId || null;
    const asientoId = silla.asientoId || null;

    let precio = 0;
    let tipoPrecio = null;
    let descuentoNombre = null;

    if (priceTemplate && priceTemplate.detalles) {
      // Assuming priceTemplate.detalles is an array of price details with zona and precio
      const detalle = priceTemplate.detalles.find(d => d.zona === zonaId);
      if (detalle) {
        precio = detalle.precio || 0;
        tipoPrecio = detalle.tipoPrecio || null;
        descuentoNombre = detalle.descuentoNombre || null;
      }
    }

    setCart(prevCart => {
      if (!prevCart) {
        return [{ sillaId, zonaId, precio, quantity: 1, tipoPrecio, descuentoNombre }];
      }
      const existingItemIndex = prevCart.findIndex(item => item.sillaId === sillaId);
      if (existingItemIndex > -1) {
        return prevCart.filter(item => item.sillaId !== sillaId);
      } else {
        return [...prevCart, { sillaId, zonaId, precio, quantity: 1, tipoPrecio, descuentoNombre }];
      }
    });
  }, [priceTemplate]);
>>>>>>> REPLACE

<<<<<<< SEARCH
  useEffect(() => {
    async function fetchMapForFunction() {
      if (!selectedFunctionId) {
        setMapa(null);
        return;
      }
      setLoading(true);
      setError(null);
      try {
        const funcion = await getFuncion(selectedFunctionId);
        if (funcion && funcion.sala && funcion.sala.id) {
          const mapData = await fetchMapa(funcion.sala.id);
          setMapa(mapData);
        } else {
          setMapa(null);
        }
      } catch (err) {
        setError(err);
        setMapa(null);
      } finally {
        setLoading(false);
      }
    }
    fetchMapForFunction();
  }, [selectedFunctionId, getFuncion, fetchMapa]); 
=======
  useEffect(() => {
    async function fetchMapAndPriceTemplateForFunction() {
      if (!selectedFunctionId) {
        setMapa(null);
        setPriceTemplate(null);
        return;
      }
      setLoading(true);
      setError(null);
      try {
        const funcion = await getFuncion(selectedFunctionId);
        if (funcion && funcion.sala && funcion.sala.id) {
          const mapData = await fetchMapa(funcion.sala.id);
          setMapa(mapData);
        } else {
          setMapa(null);
        }
        if (funcion && funcion.plantilla) {
          setPriceTemplate(funcion.plantilla);
        } else {
          setPriceTemplate(null);
        }
      } catch (err) {
        setError(err);
        setMapa(null);
        setPriceTemplate(null);
      } finally {
        setLoading(false);
      }
    }
    fetchMapAndPriceTemplateForFunction();
  }, [selectedFunctionId, getFuncion, fetchMapa]); 
