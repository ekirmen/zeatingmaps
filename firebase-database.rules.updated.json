{
  "rules": {
    "in-cart": {
      "$chart_id": {
        "$seat_id": {
          ".indexOn": ["timestamp"],
          // Allow read access to all authenticated users to see locked seats
          ".read": "auth != null",
          // Allow write access only to the session owner
          ".write": "auth != null && newData.child('session_id').val() === auth.uid",
          // Validate the data structure
          ".validate": "newData.hasChildren(['status', 'timestamp', 'session_id', 'expires', 'seatDetails']) &&
                        newData.child('status').isString() &&
                        newData.child('timestamp').isNumber() &&
                        newData.child('session_id').isString() &&
                        newData.child('expires').isNumber() &&
                        newData.child('seatDetails').hasChildren(['zona', 'precio', 'nombreMesa', 'zonaNombre', 'tipoPrecio', 'descuentoNombre'])"
        }
      }
    }
  }
}
